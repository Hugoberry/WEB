using Iserv.Niis.DataAccess.EntityFramework;
using Iserv.Niis.Domain.EntitiesFile;
using Iserv.Niis.Utils.Constans;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using Microsoft.EntityFrameworkCore;
using Iserv.Niis.Common.Codes;

namespace Iserv.Niis.Business.Helpers
{
    public static class DocumentTemplateHelper
    {
        private static readonly string TemplateEntityRootPath = "Resources/DocumentTemplates";
        private static readonly string ConclusionEntityRootPath = "Resources/ConclusionTemplates";
        private static readonly string DummyTemplateFileName = "Шаблон-заглушка";

        private static readonly Dictionary<string, string> _templateEntities;
        private static readonly Dictionary<string, string> _conclusionEntities;

        static DocumentTemplateHelper()
        {
            _templateEntities = new Dictionary<string, string>
            {
                /*{ "Приложение 1", 4216 },
                { "Приложение 2", 4220 },
                { "Приложение 3", 4098 },
                { "Приложение 4", 204 },
                { "Приложение 5", 121 },
                { "Приложение 6", 126 },
                { "Приложение 7", 1551 },
                { "Приложение 8", 122 },
                { "Приложение 9", 129 },
                { "Приложение 10", 115 },
                { "Приложение 11", 116 },
                { "Приложение 12", 124 },
                { "Приложение 13", 63 },
                { "Приложение 14", 64 },
                { "Приложение 15", 65 },
                { "Приложение 16", 44 },
                { "Приложение 17", 56 },
                { "Приложение 18", 52 },
                { "Приложение 19", 51 },
                { "Приложение 20", 16 },
                { "Приложение 21", 100 },
                { "Приложение 22", 98 },
                { "Приложение 23", 102 },
                { "Приложение 24", 99 },
                { "Приложение 25", 101 },
                { "Приложение 26", 95 },
                { "Приложение 27", 1911 },
                { "Приложение 28", 892 },
                { "Приложение 29", 4234 },
                { "Приложение 30", 13 },
                { "Приложение 31", 4235 },
                { "Приложение 32", 4236 },
                { "Приложение 33", 4237 },
                { "Приложение 34", 4238 },
                { "Приложение 35", 891 },
                { "Приложение 36", 4239 },
                { "Приложение 37", 4233 },
                { "Приложение 38", 12 },
                { "Приложение 39", 4244 },
                { "Приложение 40", 4254 },
                { "Приложение 41", 1671 },
                { "Приложение 42", 4267 },
                { "Приложение 43", 105 },
                { "Приложение 44", 104 },
                { "Приложение 45", 54 },
                { "Приложение 46", 3811 },
                { "Приложение 47", 49 },
                { "Приложение 48", 47 },
                { "Приложение 49", 42 },
                { "Приложение 50", 4230 },
                { "Приложение 51", 4231 },
                { "Приложение 54", 159 },
                { "Приложение 55", 34 },
                { "Приложение 56", 4228 },
                { "Приложение 57", 4227 },
                { "Приложение 58", 4229 },
                { "Приложение 59", 152 },
                { "Приложение 60", 4273 },
                { "Приложение 61", 511 },
                { "Приложение 62", 3091 },
                { "Приложение 63", 4283 },
                { "Приложение 64", 3213 },
                { "Приложение 65", 2278 },
                { "Приложение 66", 4217 },
                { "уведомление о внесении изменений в перечень", 2172 },
                { "Приложение 68", 4261 },
                { "Приложение 69", 4218 },
                { "уведомление о внесении изменений в наименование и адрес", 2173 },
                { "Приложение 71", 1951 },
                { "Приложение 72", 512 },
                { "Приложение 73", 514 },
                { "Приложение 74", 37 },
                { "Приложение 75", 2131 },
                { "Приложение 76", 4221 },
                { "Приложение 77", 2831 },
                { "Приложение 78", 2792 },
                { "Приложение 79", 2793 },
                { "Приложение 80", 3852 },
                { "Приложение 81", 4215 },
                { "Приложение 82", 4213 },
                { "Приложение 83", 4214 },
                { "Приложение 84", 2791 },
                { "Приложение 85", 4263 },
                { "Приложение 102", 36 },
                { "Приложение 106", 4112 },
                { "Приложение 152", 112 },
                { "Приложение 153", 3151 },
                { "Приложение 154", 2692 },
                { "Приложение 155", 4286 },
                { "Приложение 156", 2691 },
                { "Приложение 157", 119 },
                { "Приложение 158", 4093 },
                { "Приложение 159", 4109 },
                { "Приложение 162", 551 },
                { "Приложение 163", 572 },
                { "Приложение 164", 571 },
                { "Приложение 165", 4161 },
                { "Приложение 169", 2011 },
                { "Приложение 170", 149 },
                { "Приложение 171", 2071 },
                { "Приложение 172", 10 },
                { "Приложение 173", 1733 },
                { "Приложение 174", 30 },
                { "Приложение 175", 2437 },
                { "Приложение 176", 25 },
                { "Приложение 177", 117 },
                { "Приложение 178", 3171 },
                { "Приложение 179", 113 },
                { "Приложение 180", 114 },
                { "Приложение 196", 1511 },
                { "Приложение 198", 3652 },
                { "Приложение 199", 3871 },
                { "Приложение 200", 3692 },
                { "Приложение 201", 3631 },
                { "Приложение 202", 3592 },
                { "Приложение 220", 4190 },
                { "Приложение 243", 4250 },
                { "Приложение 261", 4251 },
                { "Приложение 272", 971 },
                { "Приложение 275", 4164 },
                { "Приложение 309", 4206 },
                { "Приложение 311", 2353 },
                { "Приложение 310", 1711 },
                { "Приложение 312", 4012 },
                { "Приложение 313", 2354 },
                { "Приложение 314", 4200 },
                { "Приложение 315", 2232 },
                { "Приложение 316", 2471 },
                { "Приложение 317", 2511 },
                { "Приложение 318", 2231 },
                { "Приложение 319", 4207 },
                { "Приложение 320", 2151 },
                { "Приложение 321", 1691 },
                { "Приложение 322", 3431 },
                { "Приложение 323", 2331 },
                { "Приложение 324", 2334 },
                { "Приложение 325", 2351 },
                { "Приложение 326", 2352 },
                { "Приложение 327", 4011 },
                { "Приложение 328", 3051 },
                { "Приложение 329", 3611 },
                { "Приложение 330", 4091 },
                { "Приложение 331", 3832 },
                { "Приложение 332", 3831 },
                { "Приложение 333", 2811 },
                { "Приложение 334", 3612 },
                { "Приложение 335", 2812 },
                { "Приложение 336", 2813 },
                { "Приложение 337", 2611 },
                { "Приложение 338", 2612 },
                { "Приложение 339", 2191 },
                { "Приложение 340", 2591 },
                { "Приложение 341", 2613 },
                { "Приложение 342", 1731 },
                { "Приложение 343", 4195 },
                { "Приложение 344", 1712 },
                { "Приложение 345", 4196 },
                { "Приложение 353", 674 },
                { "Приложение 355", 4167 },
                { "Приложение 366", 4199 },
                { "Приложение 370", 4148 },
                { "Приложение 371", 10016 },
                { "Приложение 372", 10015 },
                { "Приложение 373", 10012 },
                { "Приложение 374", 10013 },
                { "Приложение 375", 10014 },
                { "Приложение 382", 4115 },
                { "Приложение 386", 1531 },
                { "Приложение 387", 2174 },
                { "Приложение 389", 4198 },
                { "Приложение 390", 4095 },
                { "Приложение 391", 2711 },
                { "Приложение 392", 4179 },
                { "Приложение 393", 4193 },
                { "Приложение 400", 532 },
                { "Приложение 401", 4160 },
                { "Приложение 402", 4274 },
                { "Приложение 403", 2794 },
                { "Приложение 404", 4241 },
                { "Приложение 405", 4242 },
                { "Приложение 406", 4243 },
                { "Приложение 415", 94 },
                { "Приложение 416", 3132 },
                { "Приложение 417", 4177 },
                { "Приложение 418", 43 },
                { "Приложение 419", 4259 },
                { "Приложение 422", 3792 },
                { "Приложение 423", 156 },
                { "Приложение 424", 154},
                { "Приложение 425", 4032 },
                { "Приложение 426", 4031 },
                { "Приложение 427", 4033 },
                { "Приложение 428", 4034 },
                { "Приложение 429", 2311 },
                { "Приложение 430", 155 },
                { "Приложение 431", 157 },
                { "Приложение 432", 158 },
                { "уведомление о внесении изменений в представителя", 2171 },
                { "уведомление о внесении изменений в адрес для переписки", 2132 },
                { "Приложение 435", 88 },
                { "Приложение 436", 2871 },
                { "Приложение 437", 1471 },
                { "Приложение 438", 145 },
                { "Приложение 439", 146 },
                { "Приложение 440", 148 },
                { "Приложение 441", 35 },
                { "Приложение 442", 3912 },
                { "Приложение 443", 20 },
                { "Приложение 444", 2435 },
                { "Приложение 445", 107 },
                { "Приложение 446", 147 },
                { "Приложение 447", 2413 },
                { "Приложение 448", 136 },
                { "Приложение 449", 139 },
                { "Приложение 450", 137 },
                { "Приложение 451", 134 },
                { "Приложение 452", 3971 },
                { "Приложение 453", 138 },
                { "Приложение 454", 135 },
                { "Приложение 455", 4162 },
                { "Приложение 456", 739 },
                { "Приложение 457", 61 },
                { "Приложение 458", 740 },
                { "Приложение 459", 4130 },
                { "Приложение 460", 3251 },
                { "Приложение 461", 4178 },
                { "Приложение 462", 151 },
                { "Приложение 463", 742 },
                { "Приложение 464", 57 },
                { "Приложение 465", 513 },
                { "Приложение 466", 29 },
                { "Приложение 467", 28 },
                { "Приложение 468", 3911 },
                { "Приложение 469", 2431 },
                { "Приложение 470", 26 },
                { "Приложение 471", 2434 },
                { "Приложение 472", 150 },
                { "Приложение 473", 70 },
                { "Приложение 474", 27 },
                { "Приложение 475", 4255 },
                { "Приложение 476", 2433 },
                { "Приложение 477", 62 },
                { "Приложение 478", 72 },
                { "Приложение 479", 73 },
                { "Приложение 480", 74 },
                { "Приложение 481", 3371 },
                { "Приложение 482", 19 },
                { "Приложение 483", 4256 },
                { "Приложение 484", 59 },
                { "Приложение 485", 140 },
                { "Приложение 486", 141 },
                { "Приложение 487", 143 },
                { "Приложение 488", 144 },
                { "Приложение 489", 142 },
                { "Приложение 490", 1452 },
                { "Приложение 491", 1451 },
                { "Приложение 492", 58 },
                { "Приложение 493", 60 },
                { "Приложение 494", 4128 },
                { "Приложение 495", 4201 },
                { "Приложение 496", 3851 },
                { "Приложение 497", 48 },
                { "Приложение 498", 2752 },
                { "Приложение 499", 4202 },
                { "Приложение 501", 3311 },
                { "Приложение 502", 55 },
                { "Приложение 503", 45 },
                { "Приложение 500", 3812 },
                { "Приложение 504", 87 },
                { "Приложение 505", 3131 },
                { "Приложение 506", 14 },
                { "Приложение 507", 46 },
                { "Приложение 508", 50 },
                { "Приложение 510", 4272 },
                { "Приложение 511", 2133 },
                { "Приложение 512", 2436 },
                { "Приложение 513", 21 },
                { "Приложение 514", 4258 },
                { "Приложение 515", 2091 },
                { "Приложение 516", 4138 },
                { "Приложение 536", 118 },
                { "Приложение 537", 4170 },
                { "Приложение 538", 125 },
                { "Приложение 539", 127 },
                { "Приложение 540", 128 },
                { "Приложение 542", 131 },
                { "Приложение 543", 132 },
                { "Приложение 545", 78 },
                { "Приложение 546", 82 },
                { "Приложение 547", 85 },
                { "Приложение 576", 4151 },
                { "Приложение 577", 4150 },
                { "Приложение 578", 1751 },
                { "Приложение 579", 4197 },
                { "Приложение 580", 23 },
                { "Приложение 581", 24 },
                { "Приложение 582", 11 },
                { "Приложение 583", 3772 },
                { "заключение о регистрации ТЗ", 33 },
                { "Приложение 585", 1771 },
                { "Приложение 586", 4147 },
                { "Приложение 587", 31 },
                { "Приложение 588", 3773 },
                { "Приложение 589", 22 },
                { "Приложение 590", 2371 },
                { "Приложение 591", 4165 },
                { "Приложение 592", 2731 },
                { "Приложение 593", 4071 },
                { "Приложение 594", 32 },
                { "Приложение 595", 15 },
                { "Приложение 596", 4288 },
                { "Приложение 601", 4350 },
                { "Приложение 603", 4171 },
                { "Приложение 604", 413 },
                { "Приложение 605", 4166 },

                { "Патент на изобретение", 529 },
                { "Патент на Полезную Модель", 1292 },
                { "Патент на Промышленный образец", 391 },
                { "Патент на СД  (животноводство)", 2551 },
                { "Патент на СД  (растениеводство)", 1431 },
                { "Свидетельство на НМПТ", 3272 },
                { "Свидетельство на ТЗ", 394 },
                { "Удостоверение ИЗ", 1891 },
                { "Удостоверение ПМ", 1893 },
                { "Удостоверение ПО", 1873 },
                { "Удостоверение СДЖ", 2892 },
                { "Удостоверение СДР", 2891 },

                {"Полное описание СД", 3031},
                {"Полное описание СД (kz)", 12020},
                {"Полное описание патента ПО", 12021},
                {"Полное описание патента ПО (kz)", 12022},
                {"Полное описание патента ИЗ", 2991},
                {"Полное описание патента ПМ", 3012},
                {"Полное описание патента ИЗ (kz)", 3332},
                {"Полное описание патента ПМ (kz)", 4253},

                { "Заявление на проведение поиска ИЗ", 1971 },
                { "Приложение 612(пустое)", 4299 },
                { "Приложение 613(пустое)", 4300 },
                { "Приложение 614(пустое)", 4303 },
                { "Приложение 615(пустое)", 228 },
                { "Приложение 616(пустое)", 229 },
                { "Приложение 617(пустое)", 230 },
                { "Приложение 618(пустое)", 232 },
                { "Приложение 619(пустое)", 233 },
                { "Приложение 620(пустое)", 234 },
                { "Приложение 621(пустое)", 235 },
                { "Приложение 622(пустое)", 236 },
                { "Приложение 623(пустое)", 238 },
                { "Приложение 624(пустое)", 239 },
                { "Приложение 625(пустое)", 240 },
                { "Приложение 626(пустое)", 241 },
                { "Приложение 627(пустое)", 242 },
                { "Приложение 628(пустое)", 243 },
                { "Приложение 629(пустое)", 244 },
                { "Приложение 630(пустое)", 294 },
                { "Приложение 631(пустое)", 392 },
                { "Приложение 632(пустое)", 623 },
                { "Приложение 633(пустое)", 624 },
                { "Приложение 634(пустое)", 625 },
                { "Приложение 635(пустое)", 650 },
                { "Приложение 636(пустое)", 700 },
                { "Приложение 637(пустое)", 774 },
                { "Приложение 638(пустое)", 812 },
                { "Приложение 639(пустое)", 851 },
                { "Приложение 640(пустое)", 1131 },
                { "Приложение 641(пустое)", 1151 },
                { "Приложение 642(пустое)", 1171 },
                { "Приложение 643(пустое)", 1191 },
                { "Приложение 644(пустое)", 1192 },
                { "Приложение 645(пустое)", 1211 },
                { "Приложение 646(пустое)", 1231 },
                { "Приложение 647(пустое)", 1271 },
                { "Приложение 648(пустое)", 1291 },
                { "Приложение 649(пустое)", 1293 },
                { "Приложение 650(пустое)", 1411 },
                { "Приложение 651(пустое)", 1571 },
                { "Приложение 652(пустое)", 1572 },
                { "Приложение 653(пустое)", 2060 },
                { "Приложение 654(пустое)", 2211 },
                { "Приложение 655(пустое)", 2212 },
                { "Приложение 656(пустое)", 2213 },
                { "Приложение 657(пустое)", 2214 },
                { "Приложение 658(пустое)", 2215 },
                { "Приложение 659(пустое)", 2251 },
                { "Приложение 660(пустое)", 2252 },
                { "Приложение 661(пустое)", 2253 },
                { "Приложение 662(пустое)", 2254 },
                { "Приложение 663(пустое)", 2255 },
                { "Приложение 664(пустое)", 2256 },
                { "Приложение 665(пустое)", 2257 },
                { "Приложение 666(пустое)", 2258 },
                { "Приложение 667(пустое)", 2854 },
                { "Приложение 668(пустое)", 2855 },
                { "Приложение 669(пустое)", 2951 },
                { "Приложение 670(пустое)", 2953 },
                { "Приложение 671(пустое)", 2971 },
                { "Приложение 672(пустое)", 3071 },
                { "Приложение 673(пустое)", 3072 },
                { "Приложение 674(пустое)", 3351 },
                { "Приложение 675(пустое)", 3451 },
                { "Приложение 676(пустое)", 3472 },
                { "Приложение 677(пустое)", 3473 },
                { "Приложение 678(пустое)", 3491 },
                { "Приложение 679(пустое)", 3671 },
                { "Приложение 680(пустое)", 4096 },
                { "Приложение 681(пустое)", 4127 },
                { "Приложение 682(пустое)", 4139 },
                { "Приложение 683(пустое)", 4140 },
                { "Приложение 684(пустое)", 4141 },
                { "Приложение 685(пустое)", 4142 },
                { "Приложение 686(пустое)", 4143 },
                { "Приложение 687(пустое)", 4144 },
                { "Приложение 688(пустое)", 4145 },
                { "Приложение 689(пустое)", 4173 },
                { "Приложение 690(пустое)", 4174 },
                { "Приложение 691(пустое)", 4175 },
                { "Приложение 692(пустое)", 4181 },
                { "Приложение 693(пустое)", 4182 },
                { "Приложение 694(пустое)", 4183 },
                { "Приложение 695(пустое)", 4184 },
                { "Приложение 696(пустое)", 4185 },
                { "Приложение 697(пустое)", 4186 },
                { "Приложение 698(пустое)", 4187 },
                { "Приложение 699(пустое)", 4188 },
                { "Приложение 700(пустое)", 4204 },
                { "Приложение 701(пустое)", 4208 },
                { "Приложение 702(пустое)", 4211 },
                { "Приложение 703(пустое)", 4219 },
                { "Приложение 704(пустое)", 4222 },
                { "Приложение 705(пустое)", 4225 },
                { "Приложение 706(пустое)", 4226 },
                { "Приложение 707(пустое)", 4232 },
                { "Приложение 708(пустое)", 4245 },
                { "Приложение 709(пустое)", 4246 },
                { "Приложение 710(пустое)", 4248 },
                { "Приложение 711(пустое)", 4249 },
                { "Приложение 712(пустое)", 4257 },
                { "Приложение 713(пустое)", 4260 },
                { "Приложение 714(пустое)", 4264 },
                { "Приложение 715(пустое)", 4268 },
                { "Приложение 716(пустое)", 4269 },
                { "Приложение 717(пустое)", 4270 },
                { "Приложение 718(пустое)", 4271 },
                { "Приложение 719(пустое)", 4293 },
                { "Приложение 720(пустое)", 4294 },
                { "Приложение 721(пустое)", 4295 },
                { "Приложение 722(пустое)", 4296 },
                { "Приложение 723(пустое)", 292 },
                { "Приложение 724(пустое)", 318 },
                { "Приложение 725(пустое)", 320 },
                { "Приложение 726(пустое)", 321 },
                { "Приложение 727(пустое)", 442 },
                { "Приложение 728(пустое)", 443 },
                { "Приложение 729(пустое)", 473 },
                { "Приложение 730(пустое)", 463 },
                { "Приложение 731(пустое)", 4176 },
                { "Приложение 732(пустое)", 3751 },
                { "Приложение 733(пустое)", 4146 },
                { "Приложение 734(пустое)", 3711 },
                { "Приложение 735(пустое)", 3572 },
                { "Приложение 736(пустое)", 1852 },
                { "Приложение 737(пустое)", 2972 },

                { "Приложение 738(пустое)", 1491 },
                { "Приложение 739(пустое)", 4110 },
                { "Приложение 740(пустое)", 1932 },
                { "Приложение 741(пустое)", 811 },
                { "Приложение 742(пустое)", 3991 },
                { "Приложение 743(пустое)", 168 },
                { "Приложение 744(пустое)", 1492 },
                { "Приложение 745(пустое)", 4113 },
                { "Приложение 746(пустое)", 3111 },
                { "Приложение 747(пустое)", 4180 },
                { "Приложение 748(пустое)", 3931 },
                { "Приложение 749(пустое)", 2531 },
                { "Приложение 750(пустое)", 3331 },
                { "Приложение 751(пустое)", 3011 },
                { "Приложение 752(пустое)", 2031 },
                { "Приложение 753(пустое)", 1311 },
                { "Приложение 754(пустое)", 270 },
                { "Приложение 755(пустое)", 4129 },
                { "Приложение 756(пустое)", 4099 },

                { "Приложение 757(пустое)", 4297 },
                { "Приложение 759(пустое)", 4304 },
                { "Приложение 760(пустое)", 4306 },
                { "Приложение 761(пустое)", 4310 },
                { "Приложение 762(пустое)", 4311 },
                { "Приложение 763(пустое)", 4313 },
                { "Приложение 764(пустое)", 4314 },
                { "Приложение 765(пустое)", 4315 },
                { "Приложение 766(пустое)", 4317 },
                { "Приложение 767(пустое)", 4318 },
                { "Приложение 768(пустое)", 4322 },
                { "Приложение 769(пустое)", 4323 },
                { "Приложение 770", 10017 },
                { "Приложение 771", 10021 },
                { "Приложение 772", 10022 },
                { "Приложение 773", 10023 },
                { "Приложение 774", 10024 },
                { "Приложение 775", 10025 },
                { "Приложение 776", 10026 },
                { "Приложение 777(пустое)", 10028 },
                { "Приложение 778(пустое)", 10029 },
                { "Приложение 779(пустое)", 10030 },
                { "Уведомление о не принятии ходатайства", 12024 },
                { "заключение о предв. част. регистрации ТЗ", 12089 },
                { "решение о част. регистрации ТЗ (после согл)", 12137 },
                { "заключение о пред. отказе ТЗ (2)", 12088 },
                {"Уведомление о прекращении в связи с отсутствием ответа на запрос ПЭ по заявке на ТЗ", 12107 },
                {"уведомление о принятии решения", 12084 },
                
                {"решение об отказе в регистрации ТЗ (по истечению сроков)", 12136 },
                {"Внутренняя опись", 12183 }*/
                {DicDocumentTypeCodes.TrademarkRegistrationDecision, "решение о регистрации ТЗ" },
                {DicDocumentTypeCodes.StatementTrademark, "Заявление  ТЗ" },
                //{DicDocumentTypeCodes.ConclusionOfInventionPatentGrant, "РЕШЕНИЕ и ЗАКЛЮЧЕНИЕ о выдаче патента на изобретение(Форма ИЗ-3б)" },
                {DicDocumentTypeCodes.ConclusionOfInventionPatentGrantRefuse, "Отрицательное заключение на патент на изобретение(Форма ИЗ-4п)" },
                {DicDocumentTypeCodes.NotificationForPozitiveFormalExamination, "Уведомление о положительном результате ФЭ" },
                {DicDocumentTypeCodes.NotificationForPozitiveFormalExaminationKz, "Уведомление о положительном результате ФЭ (каз)" },
                {DicDocumentTypeCodes.IZ_OTCHET_POISK_P, "Отчет о поиске (филиал) ИЗ" },
                {DicDocumentTypeCodes.StatementInventions, "Заявление  ИЗ" },
                {DicDocumentTypeCodes.StatementSelectiveAchievs, "Заявление  СД" },
                {DicDocumentTypeCodes.OUT_Bill_V1_19, DummyTemplateFileName }, // 
                {DicDocumentTypeCodes.OUT_Ovt_na_Pismo_V1_19, DummyTemplateFileName }, // не трогаем, отсутствует
                {DicDocumentTypeCodes.OUT_Resh_Pol_chast_REG_TZ_Sogl_zayav_V1_19, "решение о част. регистрации ТЗ (после согл)" },
                {DicDocumentTypeCodes.OUT_Resh_pol_Chast_Reg_TZ_istech_srok_v1_19,"решение о част. регистрации ТЗ (без согл)"},
                {DicDocumentTypeCodes.OUT_Resh_pol_Chast_Reg_TZ_vozr_v1_19, "решение о част. регистрации ТЗ (после возражения)" },
                {DicDocumentTypeCodes.OUT_Resh_pol_Otkaz_Reg_TZ_istech_srok_v1_19, "решение об отказе в регистрации ТЗ (без согл)" },
                {DicDocumentTypeCodes.OUT_Resh_pol_Otkaz_Reg_TZ_vozr_v1_19, "решение об отказе в регистрации ТЗ (после возр)" },
                {DicDocumentTypeCodes.ExpertTmRegisterOpinion, "решение и заключение о регистрации (по итогам полной экспертизы)" },
                {DicDocumentTypeCodes.OUT_Resh_pol_Reg_TZ_vozr_v1_19, "решение о регистрации (после возражения)" },
                {DicDocumentTypeCodes.NotificationOfRegistrationDecision, "уведомление о принятии решения" },
                {DicDocumentTypeCodes.OUT_UV_GR_neprin_zayav_v1_19, DummyTemplateFileName },
                {DicDocumentTypeCodes.OUT_UV_GR_Otkaz_zayav, DummyTemplateFileName },
                {DicDocumentTypeCodes.TZPOL61, "уведомление о приостановлении дел-ва (полная экспертиза)" },
                {DicDocumentTypeCodes.MTZ_NEW_7, "уведомление о продлении срока ответа на запрос (полная экспертиза)" },
                {DicDocumentTypeCodes.OUT_UV_Pol_Reg_TZ_AP_sov_v1_19, "уведомление о регистрации (после апсовета) (полная экспертиза)" },
                {DicDocumentTypeCodes.MTZ_NEW_6, "уведомление о продлении срока подачи возражения (полная экспертиза)" },
                {DicDocumentTypeCodes.OUT_UV_POL_prodl_srok_vozr_v1_19, "уведомление о продлении срока подачи возражения (полная экспертиза)" },
                {DicDocumentTypeCodes.OUT_UV_Pol_izmen_naim_adr_v1_19, "уведомление о внесении изменений в наименование и адрес (полная экспертиза)" },
                {DicDocumentTypeCodes.OUT_UV_Pol_izmen_naim_v1_19, "уведомление о внесении изменений в наименование (полная экспертиза)" },
                {DicDocumentTypeCodes.OUT_UV_Pol_izmen_obozn_v1_19, "Уведомление о внесении изменений в обозначение (полная)" },
                {DicDocumentTypeCodes.OUT_UV_Pol_izmen_perech_v1_19, "уведомление о внесении изменений в перечень (полная экспертиза)" },
                {DicDocumentTypeCodes.OUT_UV_Pol_izmen_predstav_v1_19, "уведомление о внесении изменений в представителя (полная экспертиза)" },
                {DicDocumentTypeCodes.OUT_UV_Pol_izmen_yur_adr_v1_19, "уведомление о внесении изменений в юр. адрес (полная экспертиза)" },
                {DicDocumentTypeCodes.OUT_UV_Pol_izmen_yur_perep_adr_v1_19, "уведомление о внесении изменений в юр. адрес и адрес для переписки (полная экспертиза)" },
                {DicDocumentTypeCodes.OUT_UV_Pol_neprin_hod_v1_19, "Уведомление о не принятии ходатайства" },
                {DicDocumentTypeCodes.TZ_USTUP_PRAVA_ZN, "уведомление об уступке права (полная экспериза)"},
                {DicDocumentTypeCodes.OfficeWorkRestartNotification, "уведомление о восстановлении делопроизводства (полная экспертиза)" },
                {DicDocumentTypeCodes.NotificationReleaseRequestRegistrationNotification, "уведомление о выделении заявки (полная экспертиза)"},
                {DicDocumentTypeCodes.TZPRED3, "уведомление о прекращении в связи с отсутствием ответа на запрос (полная экспертиза)" },
                {DicDocumentTypeCodes.NotificationOfOfficeWorkTerminationByRequest, "уведомление о прекращении по просьбе (полная экспертиза)" },
                {DicDocumentTypeCodes.OUT_UV_Pred_izmen_adres_v1_19, "Уведомление о внесении изменений в адрес для переписки (предварительная)" },
                {DicDocumentTypeCodes.OUT_UV_Pred_izmen_naim_adr_v1_19,"Уведомление о внесении изменений в наименование и адрес (предварительная)" },
                {DicDocumentTypeCodes.OUT_UV_Pred_izmen_naim_v1_19, "Уведомление о внесении изменений в наименование (предварительная)" },
                {DicDocumentTypeCodes.OUT_UV_Pred_izmen_obozn_v1_19, "Уведомление о внесении изменений в обозначение (предварительная)" },
                {DicDocumentTypeCodes.OUT_UV_Pred_izmen_perech_v1_19, "уведомление о внесении изменений в перечень МКТУ (предварительная)" },
                {DicDocumentTypeCodes.OUT_UV_Pred_izmen_predstav_v1_19, "Уведомление о внесении изменений в представителя (предварительная)" },
                {DicDocumentTypeCodes.OUT_UV_Pred_izmen_yur_adr_v1_19,"Уведомление о внесении изменений в юридический адрес (предварительная)"},
                {DicDocumentTypeCodes.OUT_UV_Pred_izmen_yur_perep_adr_v1_19,"Уведомление о внесении изменений в юридический адрес и адрес для переписки (предварительная)" },
                {DicDocumentTypeCodes.OUT_UV_Pred_Prekr_del_bez_opl_v1_19, "Уведомление о прекращении делопроизводства в связи с отсутствием оплаты" },
                {DicDocumentTypeCodes.OUT_Uv_pred_prekr_del_net_opl_exp_v1_19, "Уведомление о прекращении делопроизводства  (в связи с неуплатой за полную экспертизу)" },
                {DicDocumentTypeCodes.OUT_Uv_pred_prekr_del_otv_zap_v1_19, "Уведомление о прекращении делопроизводства (в связи с отсутствием ответа на запрос) (предварительная)" },
                {DicDocumentTypeCodes.OUT_Uv_pred_prekr_del_prosb_zayav_v1_19, "Уведомление о прекращении делопроизводства (по просьбе заявителя) (предварительная)" },
                {DicDocumentTypeCodes.OUT_UV_Pred_preobr_zayav_KTZ_na_TZ_v1_19, "Уведомление о преобразовании заявки на КТЗ в заявку на ТЗ (предварительная)" },
                {DicDocumentTypeCodes.OUT_UV_Pred_preobr_zayav_TZ_na_KTZ_v1_19, "Уведомление о преобразовании заявки на ТЗ в заявку на КТЗ (предварительная)" },
                {DicDocumentTypeCodes.OUT_UV_Pred_prodl_srok_na_otv_v1_19, "Уведомление о продлении срока предоставления ответа на запрос (предварительная)" },
                {DicDocumentTypeCodes.NotificationOfTmRequestReviewingAcceptance, "Уведомление о принятии к рассмотрению заявки на регистрацию ТЗ_знака обслуживания (без оплаты за полную экспертизу)" },
                {DicDocumentTypeCodes.TZPRED1, "Уведомление о принятии к рассмотрению заявки на регистрацию ТЗ_знака обслуживания" },
                {DicDocumentTypeCodes.OUT_UV_Pred_ustup_v1_19, DummyTemplateFileName },
                {DicDocumentTypeCodes.OUT_UV_Pred_vost_del_v1_19, "Уведомление о восcтановлении делопроизводства (предварительная)"},
                {DicDocumentTypeCodes.OUT_UV_Pred_vyd_zayavTZ_v1_19, "Уведомление о выделении заявки на ТЗ (предварительная)" },
                {DicDocumentTypeCodes.OUT_Zakl_Pol_Predv_otkaz_Chast_Reg_TZ_V1_19, "заключение о предв. част. регистрации ТЗ" },
                {DicDocumentTypeCodes.OUT_Zakl_Pol_Predv_otkaz_Reg_TZ_V1_19, "заключение о пред. отказе ТЗ" },
                {DicDocumentTypeCodes.СertificateOfConfidentiality, "секретка" },
                //{DicDocumentTypeCodes.OUT_Zap_Pol_avtor_v1_19, "запрос по пп.3) п.2 ст.7 Закона (полная экспертиза)" },
                //{DicDocumentTypeCodes.OUT_Zap_Pol_dover_v1_19, "запрос на доверенность (полная экспертиза)" },
                {DicDocumentTypeCodes.OUT_Zap_Pol_dover_v1_19, "Запрос по завке на ТЗ" },
                //{DicDocumentTypeCodes.OUT_Zap_Pol_gos_sim_v1_19, "запрос по п.2 ст.6 Закона (полная экспертиза)" },
                //{DicDocumentTypeCodes.OUT_Zap_Pol_kach_izobr_v1_19, "запрос на качественные изображения (полная экспертиза)"},
                //{DicDocumentTypeCodes.OUT_Zap_Pol_kult_dost_v1_19, "запрос по п.3 ст.7 (полная экспертиза)" },
                //{DicDocumentTypeCodes.OUT_Zap_Pol_lich_neimush_v1_19, "запрос по пп.4) п.2 ст.7 Закона (полная экспертиза)" },
                //{DicDocumentTypeCodes.OUT_Zap_Pol_obyect_sv_v1_19, "запрос на объективную связь (полная экспертиза)" },
                //{DicDocumentTypeCodes.OUT_Zap_Pol_perevod_oboz_v1_19, "запрос на перевод обозначений (полная экспертиза)" },
                //{DicDocumentTypeCodes.OUT_Zap_Pol_pismo_sogl_v1_19, "запрос на письмо-согласие соответ. требованиям (полная экспертиза)" },
                /*{DicDocumentTypeCodes.OUT_Zap_Pred_Adres_v1_19, DummyTemplateFileName },
                {DicDocumentTypeCodes.OUT_Zap_Pred_ECO_v1_19, "Запрос по обозначению ECO BIO Organic" },
                {DicDocumentTypeCodes.OUT_Zap_Pred_Nesootv_MKTU_v1_19, "Запрос по несоответствию товаров и услуг МКТУ" },
                {DicDocumentTypeCodes.OUT_Zap_Pred_Perevod_v1_19, "Запрос предварительной экспертизы"},
                {DicDocumentTypeCodes.OUT_Zap_Pred_dover_v1_19, "Запрос на доверенность ПЭ" },
                {DicDocumentTypeCodes.OUT_Zap_Pred_gos_sim_v1_19, "Запрос по п.2 ст.6 Закона (предварительная)"},
                {DicDocumentTypeCodes.OUT_Zap_Pred_kach_izobr_v1_19, "Запрос на качественные изображения (предварительная)" },
                {DicDocumentTypeCodes.OUT_Zap_Pred_otsut_izobr_v1_19, DummyTemplateFileName },
                {DicDocumentTypeCodes.OUT_Zap_Pred_otsuts_MKTU_v1_19, "Запрос по отсутствию МКТУ или изображения" },
                {DicDocumentTypeCodes.OUT_Zap_Pred_perevod_oboz_v1_19, "Запрос на перевод обозначений (предварительная)" },
                {DicDocumentTypeCodes.OUT_Zap_Pred_Prior_v1_19, "Запрос по приоритету ПЭ" },*/
                {DicDocumentTypeCodes.IN01_vn_opis_V1_19, "Внутренняя опись" },
                {DicDocumentTypeCodes.UV_TZ_VN_IZM_PERECH_TOV, "Уведомление о внесении изменений в заявленный перечень товаров и услуг" },
                {"Addressee", "Addressee" },
                //{DicDocumentTypeCodes.NotificationOfDecisionPatentGrant, "NotificationDecisionGrantPatentIZ" },
                {DicDocumentTypeCodes.ApplicationIssuingSecurityDocument, "ApplicationIssuingSecurityDocument" },
                {DicDocumentTypeCodes.DecisionConclusionGrantPatent, "Решение и Заключение о выдаче патента на изобретение" },
                {DicDocumentTypeCodes.PO5_1111, "PO5-1111" },
                {DicDocumentTypeCodes.PO5_10, "PO5_10" },

                {DicDocumentTypeCodes.GrantingUsefulModel, "GrantingUsefulModel" },
                {DicDocumentTypeCodes.GrantingUsefulModelKz, "GrantingUsefulModelKz" },

                //{DicDocumentTypeCodes.DecisionConclusionRefusalGrantPatent, "DecisionConclusionRefusalGrantPatent" },
                //{DicDocumentTypeCodes.NotificationPositiveResultFEWithoutPaying, "4.7_1_Уведомление о положительном результате ФЭ (без оплаты за экспертизу по сущ.)" },
                {DicDocumentTypeCodes.NotificationPositiveResultFEWithoutPayingKz, "NotificationPositiveResultFEWithoutPayingKz" },
                {DicDocumentTypeCodes.DK_UVED_POL_TZ, "AgreementRegistrationNotice" },
                {DicDocumentTypeCodes.NoticeRefusalRegisterContract, "NoticeRefusalRegisterContract" },
                {DicDocumentTypeCodes.CancellationNotice, "CancellationNotice" },
                {DicDocumentTypeCodes.TerminationNotice, "TerminationNotice" },
                {DicDocumentTypeCodes.NotificationOfDecisionPatentGrant, "33_Уведомление о принятии решения о выдаче патента (УВ-Кб)" },
                //{DicDocumentTypeCodes.RequestApplicantSpecifyingRegistrationAgreement, "RequestApplicantSpecifyingRegistrationAgreement" },
                {DicDocumentTypeCodes.RegisterTransferInformationContracts, "RegisterTransferInformationContracts" },
                {DicDocumentTypeCodes.TrademarkCertificate, "Свидетельство на ТЗ" },
                //{DicDocumentTypeCodes.InventionSearchReport, "Отчет о поиске ИЗ"},
                
                {DicDocumentTypeCodes.UV_KPM, "UsefulModelPatentDecisionNotice" },
                {DicDocumentTypeCodes.StatementFromBank, "StatementFromBank"},
                {DicDocumentTypeCodes.FE6, "shablon_uvedoml_j_prodl_sroka_otveta" },
                {DicDocumentTypeCodes._006_0088,"NotificationRestoreTermResponseExaminationRequest" },
                {DicDocumentTypeCodes.RequestForExaminationOfInventionPatentRequest,"shablon_ИЗ-2б" },

                {DicDocumentTypeCodes.PO10,"ОТЧЕТ_О_ПОИСКЕ_PO" },

                {DicDocumentTypeCodes.SelectiveAchievementPatentNotification,"uvedoml_vyda4i_patenta" },
                {DicDocumentTypeCodes.S12,"exp_zakl" },
                {DicDocumentTypeCodes.SelectiveAchievementExpertConclusionNotification,"uvedoml_polozit_zaklyu4" },
            };

            _conclusionEntities = new Dictionary<string, string>
            {
                /*{"ExpertConclusionByRequest", 4224},
                {"InventionExpertSearchReport",4247 },
                {"InventionExpertSearchReportBranch",3191 },
                {"ResultDistributionApplications",10020},*/
                {DicDocumentTypeCodes.TZPOL555, "ExpertConclusionByRequest"},
                {DicDocumentTypeCodes.TZPOL555PR, "ExpertConclusionByRequest"},
                {DicDocumentTypeCodes.TZPOL555PRWD, "ExpertConclusionByRequest"},
                {DicDocumentTypeCodes.TZPOL555PF, "ExpertConclusionByRequest"},
                //Todo! актуализировать, когда дойдем до изобретений
                {DicDocumentTypeCodes.InventionSearchReport, "InventionExpertSearchReport"},
                {DicDocumentTypeCodes.ResultDistributionRequests, "ResultDistributionApplications"}
            };
        }

        public static void CreateTemplateEntities(NiisWebContext context, string rootPath)
        {
            var templatesWithIds = GetTemplateFileIdsDictionary(_templateEntities, context);
            var conclusionsWithIds = GetTemplateFileIdsDictionary(_conclusionEntities, context);
            var documentTemplateFiles = GetDocumentTemplateFiles(templatesWithIds, rootPath, TemplateEntityRootPath);
            documentTemplateFiles.AddRange(GetDocumentTemplateFiles(conclusionsWithIds, rootPath, ConclusionEntityRootPath));

            context.DocumentTemplateFiles.AddRange(documentTemplateFiles);
            context.SaveChanges();
        }
        public static void UpdateTemplateEntities(NiisWebContext context, string rootPath)
        {
            UploadDocumentTemplateFiles(_templateEntities, rootPath, TemplateEntityRootPath, context);
            UploadDocumentTemplateFiles(_conclusionEntities, rootPath, ConclusionEntityRootPath, context);
        }

        #region Private Methods

        private static List<DocumentTemplateFile> GetDocumentTemplateFiles(
            Dictionary<string, int> templateInfos,
            string rootPath,
            string templatesRootPath)
        {
            var documentTemplateFiles = new List<DocumentTemplateFile>();
            foreach (var template in templateInfos)
            {
                var path = Path.Combine($"{rootPath}/{templatesRootPath}", $"{template.Key}.{FileTypes.Docx}");
                var fileBytes = File.ReadAllBytes(path);

                documentTemplateFiles.Add(new DocumentTemplateFile
                {
                    Id = template.Value,
                    DateCreate = DateTimeOffset.Now,
                    DateUpdate = DateTimeOffset.Now,
                    FileType = ContentType.Docx,
                    FileName = $"{template.Key}.{FileTypes.Docx}",
                    File = fileBytes,
                    FileSize = fileBytes.Length
                });
            }

            return documentTemplateFiles;
        }

        private static Dictionary<string, int> GetTemplateFileIdsDictionary(Dictionary<string, string> templateEntities,
            NiisWebContext context)
        {
            var result = new Dictionary<string, int>();
            foreach (var templateEntity in templateEntities)
            {
                var type = context.DicDocumentTypes.FirstOrDefault(d => d.Code == templateEntity.Value);
                if (type != null)
                {
                    result.Add(templateEntity.Key, type.Id);
                }
            }
            return result;
        }

        private static void UploadDocumentTemplateFiles(
            Dictionary<string, string> templateEntities,
            string rootPath,
            string templatesRootPath,
            NiisWebContext context)
        {
            foreach (var template in templateEntities)
            {
                var type = context.DicDocumentTypes.FirstOrDefault(d => d.Code == template.Key);

                if (type != null)
                {
                    using (var transaction = context.Database.BeginTransaction())
                    {
                        context.Database.ExecuteSqlCommand("SET IDENTITY_INSERT [dbo].[DocumentTemplateFiles] ON");
                        var dbTemplate = context.DocumentTemplateFiles.SingleOrDefault(x => x.Id == type.Id);

                        var path = Path.Combine($"{rootPath}/{templatesRootPath}",
                            $"{template.Value}.{FileTypes.Docx}");

                        var fileBytes = File.ReadAllBytes(path);

                        if (dbTemplate != null)
                        {
                            dbTemplate.DateUpdate = DateTimeOffset.Now;
                            dbTemplate.File = fileBytes;
                            dbTemplate.FileSize = fileBytes.Length;

                            context.DocumentTemplateFiles.Update(dbTemplate);
                        }
                        else
                        {
                            dbTemplate = new DocumentTemplateFile
                            {
                                DateCreate = DateTimeOffset.Now,
                                DateUpdate = DateTimeOffset.Now,
                                File = fileBytes,
                                FileSize = fileBytes.Length,
                                FileName = $"{template.Value}.{FileTypes.Docx}",
                                Id = type.Id
                            };

                            context.DocumentTemplateFiles.Add(dbTemplate);
                        }

                        type.TemplateFileId = dbTemplate.Id;
                        context.DicDocumentTypes.Update(type);
                        context.SaveChanges();
                        context.Database.ExecuteSqlCommand("SET IDENTITY_INSERT [dbo].[DocumentTemplateFiles] OFF");

                        transaction.Commit();                    }
                }
            }
        }

        #endregion
    }
}
